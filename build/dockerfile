FROM golang:1.20-alpine as builder

WORKDIR /work

RUN go env -w GOPROXY=https://goproxy.cn,direct && go env -w CGO_ENABLED=0
COPY go.mod go.sum ./
RUN go mod download

COPY .  ./
RUN go build -o datacenter ./datacenter.go


FROM alpine:latest

WORKDIR /datacenter-controller

COPY --from=builder /work/datacenter-controller ./
CMD ["./datacenter","serve"]
